<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phishing URL Inspector</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc;
        }
        .card {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .risk-low { border-left: 4px solid #10b981; } /* Emerald */
        .risk-medium { border-left: 4px solid #f59e0b; } /* Amber */
        .risk-high { border-left: 4px solid #ef4444; } /* Red */
    </style>
</head>
<body class="min-h-screen flex items-start justify-center p-4 sm:p-8">
    <div class="w-full max-w-2xl mt-8 bg-white rounded-xl card p-6 sm:p-8">
        <h1 class="text-3xl font-bold text-gray-800 mb-2 flex items-center">
            <svg class="w-7 h-7 mr-2 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
            Phishing URL Inspector
        </h1>
        <p class="text-sm text-gray-500 mb-6">Paste a suspected URL (from a QR code preview, email, or text) to check for common phishing risks.</p>

        <!-- Input Area -->
        <div class="mb-6">
            <label for="url-input" class="block text-sm font-medium text-gray-700 mb-2">URL to Inspect</label>
            <input type="text" id="url-input" placeholder="e.g., https://secure-login.com" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150">
        </div>
        
        <button onclick="inspectUrl()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-lg transition duration-150 ease-in-out transform hover:scale-[1.005] mb-6">
            Analyze URL
        </button>

        <!-- Analysis Results -->
        <div id="results-container" class="hidden">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Analysis Report</h2>
            
            <div id="risk-summary" class="p-4 rounded-xl mb-6 transition duration-300">
                <p class="text-lg font-bold flex items-center">
                    <span id="risk-icon" class="mr-2"></span>
                    Risk Assessment: <span id="risk-level" class="ml-2 font-extrabold"></span>
                </p>
            </div>

            <div id="details-container" class="space-y-4">
                <!-- Details will be injected here -->
            </div>
        </div>
        
        <!-- Message Box for Errors -->
        <div id="message-box" class="mt-4 hidden p-3 text-sm rounded-lg bg-red-100 text-red-700" role="alert"></div>
    </div>

    <script>
        const urlInput = document.getElementById('url-input');
        const resultsContainer = document.getElementById('results-container');
        const detailsContainer = document.getElementById('details-container');
        const riskSummary = document.getElementById('risk-summary');
        const riskLevelDisplay = document.getElementById('risk-level');
        const riskIcon = document.getElementById('risk-icon');
        const messageBox = document.getElementById('message-box');

        // Helper function for custom message box (no alert())
        function showMessage(text, type = 'error') {
            messageBox.textContent = text;
            messageBox.classList.remove('hidden', 'bg-red-100', 'text-red-700', 'bg-yellow-100', 'text-yellow-700');
            messageBox.classList.add('block');

            if (type === 'warning') {
                messageBox.classList.add('bg-yellow-100', 'text-yellow-700');
            } else {
                messageBox.classList.add('bg-red-100', 'text-red-700');
            }
        }
        
        // Helper function to create a detail row for the report
        function createDetailRow(label, value, statusClass, statusText, iconSvg) {
            return `
                <div class="p-4 bg-gray-50 rounded-lg">
                    <div class="flex justify-between items-start">
                        <p class="text-gray-600 font-medium">${label}: <span class="text-gray-900 font-normal break-all">${value}</span></p>
                        <div class="flex items-center text-sm font-semibold ${statusClass} rounded-full px-3 py-1 ml-4 whitespace-nowrap">
                            ${iconSvg}
                            ${statusText}
                        </div>
                    </div>
                </div>
            `;
        }

        function inspectUrl() {
            const urlString = urlInput.value.trim();
            messageBox.classList.add('hidden');
            resultsContainer.classList.add('hidden');
            detailsContainer.innerHTML = '';

            if (!urlString) {
                showMessage("Please enter a URL to inspect.");
                return;
            }

            try {
                // 1. Try to parse the URL
                const url = new URL(urlString);
                
                // 2. Initialize Risk Assessment
                let riskScore = 0;
                let detailsHtml = '';
                let host = url.hostname.toLowerCase();

                // --- CHECK 1: Protocol Security (HTTPS) ---
                const isSecure = url.protocol === 'https:';
                if (!isSecure) riskScore += 1;
                detailsHtml += createDetailRow(
                    'Protocol',
                    url.protocol,
                    isSecure ? 'text-emerald-700 bg-emerald-100' : 'text-red-700 bg-red-100',
                    isSecure ? 'Secure (HTTPS)' : 'Insecure (HTTP)',
                    isSecure ? `<svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 4.04A11.955 11.955 0 005.432 14.74a11.942 11.942 0 001.543 2.52C8.342 19.341 10.742 20.916 12 21.657c1.258-.74 3.658-2.316 5.025-4.396a11.942 11.942 0 001.543-2.52 11.955 11.955 0 00-.07-7.79z"></path></svg>` : `<svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>`
                );

                // --- CHECK 2: Obfuscation (Non-standard port) ---
                const isCustomPort = url.port !== '' && url.port !== '80' && url.port !== '443';
                if (isCustomPort) riskScore += 1;
                detailsHtml += createDetailRow(
                    'Port Used',
                    url.port || 'Standard (80/443)',
                    isCustomPort ? 'text-amber-700 bg-amber-100' : 'text-emerald-700 bg-emerald-100',
                    isCustomPort ? 'Warning: Non-Standard Port' : 'Standard Port',
                    isCustomPort ? `<svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>` : `<svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>`
                );

                // --- CHECK 3: Suspicious Keywords in Path ---
                const suspiciousKeywords = ['login', 'verify', 'update', 'security', 'billing'];
                const pathContainsSuspicious = suspiciousKeywords.some(keyword => url.pathname.toLowerCase().includes(keyword));
                const pathText = url.pathname.length > 50 ? url.pathname.substring(0, 50) + '...' : url.pathname || '/';
                
                // Only flag if it's suspicious AND the host is not a well-known service (this check is heuristic)
                const isKnownService = host.includes('google.com') || host.includes('microsoft.com') || host.includes('apple.com');
                let pathRisk = false;
                if (pathContainsSuspicious && !isKnownService) {
                    riskScore += 2;
                    pathRisk = true;
                }

                detailsHtml += createDetailRow(
                    'URL Path',
                    pathText,
                    pathRisk ? 'text-red-700 bg-red-100' : 'text-emerald-700 bg-emerald-100',
                    pathRisk ? 'High-Risk Keywords' : 'Common Path',
                    pathRisk ? `<svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>` : `<svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>`
                );

                // --- CHECK 4: Domain Name Inspection (The most important part) ---
                let domainRisk = 'No obvious flags.';
                let domainStatusClass = 'text-emerald-700 bg-emerald-100';

                // Check for IP address use
                const isIpAddress = host.match(/^(\d{1,3}\.){3}\d{1,3}$/);
                if (isIpAddress) {
                    riskScore += 3;
                    domainRisk = 'HIGH RISK: Domain is an IP address. Extremely suspicious.';
                    domainStatusClass = 'text-red-700 bg-red-100';
                }

                // Check for brand impersonation (e.g., 'micros0ft.com' vs 'microsoft.com')
                const deceptiveDomains = [
                    { check: 'micros0ft', real: 'microsoft' },
                    { check: 'g00gle', real: 'google' },
                    { check: 'paypa1', real: 'paypal' },
                    { check: 'amzon', real: 'amazon' }
                ];

                for (const item of deceptiveDomains) {
                    if (host.includes(item.check) && !host.includes(item.real)) {
                        riskScore += 4;
                        domainRisk = `CRITICAL: Looks like brand impersonation (Typosquatting) of ${item.real}!`;
                        domainStatusClass = 'text-red-700 bg-red-100';
                        break;
                    }
                }
                
                detailsHtml += createDetailRow(
                    'Hostname',
                    host,
                    domainStatusClass,
                    domainRisk,
                    domainStatusClass.includes('red') ? `<svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>` : `<svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>`
                );


                // --- Final Risk Display ---
                let finalRiskLevel, finalRiskClass, finalRiskIconSvg;
                
                if (riskScore >= 4) {
                    finalRiskLevel = 'HIGH RISK';
                    finalRiskClass = 'bg-red-50 text-red-700 risk-high';
                    finalRiskIconSvg = '<svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>';
                } else if (riskScore >= 2) {
                    finalRiskLevel = 'MEDIUM RISK';
                    finalRiskClass = 'bg-amber-50 text-amber-700 risk-medium';
                    finalRiskIconSvg = '<svg class="w-6 h-6 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>';
                } else {
                    finalRiskLevel = 'LOW RISK';
                    finalRiskClass = 'bg-emerald-50 text-emerald-700 risk-low';
                    finalRiskIconSvg = '<svg class="w-6 h-6 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 4.04A11.955 11.955 0 005.432 14.74a11.942 11.942 0 001.543 2.52C8.342 19.341 10.742 20.916 12 21.657c1.258-.74 3.658-2.316 5.025-4.396a11.942 11.942 0 001.543-2.52 11.955 11.955 0 00-.07-7.79z"></path></svg>';
                }

                // Update the results display
                riskSummary.className = 'p-4 rounded-xl mb-6 transition duration-300 ' + finalRiskClass;
                riskLevelDisplay.textContent = finalRiskLevel;
                riskIcon.innerHTML = finalRiskIconSvg;
                detailsContainer.innerHTML = detailsHtml;
                resultsContainer.classList.remove('hidden');

            } catch (e) {
                // If URL parsing fails (e.g., if it's not a valid URL format)
                showMessage(`Invalid URL format. Please ensure it starts with http:// or https://. Error: ${e.message}`);
                console.error(e);
            }
        }
    </script>
</body>
</html>
